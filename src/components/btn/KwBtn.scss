@mixin kw-btn-height-modifier($padding, $line-height, $font-size, $font-weight) {
  &.q-btn {
    font-size: $font-size;
    line-height: $line-height;
    padding: $padding;
    font-weight: $font-weight;
    min-height: calc(#{$line-height} + #{ at($padding, 1) + at($padding, 3) });

    // .q-icon,
    // .q-spinner {
    //   font-size: $line-height;
    // }
  }
}

@mixin kw-btn-custom-color-action($name, $color, $hover-color, $action-color) {
  .kw-btn--filled,
  .kw-btn--outlined {
    &.kw-btn--color-#{$name} {
      background-color: $color;
    }

    @at-root body.desktop {
      .kw-btn.kw-btn--color-#{$name} {
        &.q-focusable:focus,
        &.q-manual-focusable--focused,
        &.q-hoverable:hover {
          background-color: $hover-color;

          &::before {
            background-color: #fff;
          }
        }

        &.q-btn.q-btn--active {
          background-color: $action-color;

          &::before {
            background-color: #fff;
          }
        }
      }
    }
  }
}

.kw-btn {
  $-kw-btn-padding: $button-padding;
  $-kw-btn-padding-form: 8px 12px 8px 12px;
  $-kw-btn-line-height: $button-line-height;
  $-kw-btn-font-size: $button-font-size;
  $-kw-btn-font-weight: $button-font-weight;
  $-kw-btn-padding-dense: $button-dense-padding;
  $-kw-btn-line-height-dense: $kw-field-line-height-dense;
  $-kw-btn-font-size-dense: $kw-field-font-size-dense;
  $-kw-btn-font-weight-dense: $button-font-weight;

  // about color
  $-color-list: $semantic-colors;

  align-self: center; // quasar only provide stretch true...!

  &.self-stretch {
    align-self: stretch;
  }

  // coloring
  @include color-based("&.kw-btn--border-color-", $-color-list) using($color) {
    &::after {
      border-color: $color;
    }
  }

  @include color-based("&.kw-btn--color-", $-color-list) using($color) {
    background-color: $color;
  }

  @include color-based("&.kw-btn--text-color-", $-color-list) using($color) {
    color: $color; // border default.

    &.q-btn {
      .q-btn__content {
        color: $color;
      }
    }
  }

  @include kw-btn-height-modifier($-kw-btn-padding, $-kw-btn-line-height, $-kw-btn-font-size, $-kw-btn-font-weight);

  &--form {
    @include kw-btn-height-modifier($-kw-btn-padding-form, $-kw-btn-line-height, $-kw-btn-font-size, $-kw-btn-font-weight);
  }

  &.q-btn {
    // the height and width depend on contents line-height and padding.

    .on-left {
      margin-right: 4px;
    }

    .on-right {
      margin-left: 4px;
    }

    .q-icon,
    .q-spinner {
      font-size: 16px; // design concept.
    }

    &::before {
      mix-blend-mode: multiply;
      background-color: #fff;
    }

    &.disabled {
      opacity: 1;
      background-color: $line-line;

      .q-btn__content {
        color: $bg-white;
      }
    }

    &--dense {
      @include kw-btn-height-modifier($-kw-btn-padding-dense, $-kw-btn-line-height-dense, $-kw-btn-font-size-dense, $-kw-btn-font-weight-dense);

      &.on-left {
        margin-right: 4px;
      }

      &.on-right {
        margin-left: 4px;
      }
    }
  }

  &--outlined {
    &::before {
      mix-blend-mode: multiply;
      background-color: #fff;
    }

    &::after {
      content: "";
      display: block;
      position: absolute;
      left: 0;
      right: 0;
      top: 0;
      bottom: 0;
      border-radius: inherit;
      border: 1px solid currentcolor;
    }

    &.q-btn {
      &.disabled {
        background-color: $line-bg;

        .q-btn__content {
          color: $placeholder;
        }

        &::after {
          border-color: $line-stroke;
        }
      }
    }
  }

  &--underline {
    // &::before {
    //   border-bottom: 1px solid currentcolor;
    // }

    text-decoration: underline;

    &.q-btn {
      &.disabled {
        background-color: transparent;
        color: $placeholder;

        .q-btn__content {
          color: $placeholder;
        }
      }
    }
  }

  &--borderless {
    background-color: transparent;

    &.q-btn {
      @include kw-btn-height-modifier(0, $-kw-btn-line-height, $-kw-btn-font-size, $-kw-btn-font-weight);

      &.disabled {
        background-color: transparent;

        .q-btn__content {
          color: $placeholder;
        }
      }

      &--dense {
        @include kw-btn-height-modifier(0, $-kw-btn-line-height-dense, $-kw-btn-font-size-dense, $-kw-btn-font-weight-dense);
      }
    }
  }
}

body.desktop {
  .kw-btn {
    .q-focus-helper {
      /*
      Since design requirements, we can not use focus helper.
      Cuase, it affects both the background color and the color at the same time.
       */
      display: none;
    }

    transition: box-shadow 300ms;

    &--filled,
    &--outlined {
      &.q-focusable:focus,
      &.q-manual-focusable--focused,
      &.q-hoverable:hover {
        &::before {
          background-color: adjust-color(#fff, $lightness: -10%);
        }
      }

      &.q-btn.q-btn--active {
        &::before {
          background-color: adjust-color(#fff, $lightness: -20%);
        }
      }

      &.kw-btn--color-bg-white {
        &.q-focusable:focus,
        &.q-manual-focusable--focused,
        &.q-hoverable:hover {
          &::before {
            background-color: adjust-color(#fff, $lightness: -5%);
          }
        }

        &.q-btn.q-btn--active {
          &::before {
            background-color: adjust-color(#fff, $lightness: -10%);
          }
        }
      }
    }
  }
}

@include kw-btn-custom-color-action("table-blue", change-color($primary, $alpha: 0.08), change-color($primary, $alpha: 0.18), change-color($primary, $alpha: 0.28)); // notice! this is exception.
